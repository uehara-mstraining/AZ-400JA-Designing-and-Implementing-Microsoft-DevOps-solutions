---
lab:
  title: "ラボ: Azure Repos での Git によるバージョン管理"
  module: "モジュール 4: エンタープライズ DevOps での Git のスケーリング"
---

# ラボ: Azure Repos の Git によるバージョン管理

# 学生用ラボ マニュアル

## ラボの概要

プルリクエストを使用すると、コードをマスターブランチにマージする前に、チームが機能ブランチの変更についてフィードバックを提供できます。レビューアは、提案された変更をステップスルーし、コメントを残し、投票してコードを承認または却下できます。Azure DevOps は、プルリクエストを作成、確認、承認するための豊富なエクスペリエンスを提供します。

## 演習 1：プルリクエストの操作

Git ラボが終了したとき、新しいブランチを作成し、一部のコードに変更を加えました。次に、その変更を新しいブランチにコミットして、サーバーにプッシュする必要があります。そこに到達したら、プルリクエストを作成して、ブランチをマスターとマージできるようにします。

### タスク 1：新しいプルリクエストの作成

1. **Visual Studio Code**に戻ります。

1. 左下の**master**ボタンをクリックし、master ブランチから新しく「release」という名前のブランチを作成します。

1. **ソース管理**タブを選択します。**Category.cs**にコミットされていない変更があることを確認します。**Category change**というコメントを入力し、**Ctrl + Enter**を押して、ローカルの**master**ブランチにコミットします。

1. **変更の発行**ボタンをクリックして、コミットをサーバーにプッシュします。

1. Azure DevOps ポータルの垂直ナビゲーション ペインで、「**Repos**」配下の Pull requests を選択します。

1. 「You updated release Just now」というコメントがあることを確認します。

1. そのメッセージの右側にある、「Create a pull reequest」 をクリックします。

1. Pull request は自由にカスタマイズできます。また、作成時にブランチに関連付けられたワークアイテムが参照できることに注意してください。「Create」をクリックします。

### タスク 2：プルリクエストの管理

1. [**Overview**]タブには、作成フォームで指定されたすべての重要な情報と、リクエストを承認して完了するためのオプションが含まれています。

1. [**Files**]タブを選択して、コミットに関係するファイルを確認します。

1. レビュワーは自由にコメントを追加可能です。

1. [**Updates**]タブを選択します。これには、ブランチの更新に関する詳細が含まれています。

1. ブランチに対して行われたコミットを確認できる[**Commits**]タブを選択します。

1. すべてが正常に行われているようですので、プルリクエストを**Approve**します。

1. プルリクエストを**Complete**します。

1. **Complete merge**をクリックします。

1. マージが完了すると、プルリクエストは**Completed**としてマークされます。

1. **Pull requests**のホームに戻ります。

1. [**Completed**]タブを選択し、プルリクエストをクリックします。

1. プルリクエストを確認し、必要に応じて**Cherry-pick**または**Revert**こともできます。チェリーピッキングは、あるブランチから特定のコミットを選択して別のブランチに適用するプロセスであり、概念的にはコピー/貼り付け操作と同様です。

## タスク 3：Git ブランチとプルリクエストポリシーの管理

1. **Project settings**を開きます。

1. **Repos**の下の**Repositories**を選択します。

1. **PartsUnlimited**リポジトリを選択します。Azure DevOps の他のすべてと同様に、セキュリティを非常に詳細に管理できます。これにより、ユーザーがリポジトリをフォークできるようにするかどうか、議論された作業項目が自動的にリンクされるかどうかなど、いくつかの便利なポリシーを設定できます。

1. 「Policies」をクリックし、**master**ブランチを選択します。リポジトリと同様に、セキュリティ設定を大幅に制御できます。ブランチが実施するさまざまなポリシーを定義することもできます。**Branch Policies**を確認します。

1. Azure DevOps ブランチポリシーは、リポジトリで一定レベルの品質管理を実施するのに非常に効果的です。たとえば、最小限のレビュー担当者を要求したり、リンクされた作業項目をチェックしたり、すべてのコメントが解決されていることを要求したりすることで、プルリクエストを制御できます。ビルドを成功させて検証を要求し、外部承認サービスを構成することもできます。独自の承認者を含める必要があるコードの特定のセクションがある場合は、ここにも含めることができます。

1. **Require a minimum number of reviewers**をチェックします。デフォルトでは、これにはプルリクエストを承認するために少なくとも 2 人のレビューアが必要であり、（デフォルトでは）元の作成者がその 1 人ではないことも必要です。

1. **Automatically included reviewers**をクリックします。

1. 自分を**Reviewer**として追加し、**パスフィルター**を

   ```
   /PartsUnlimited-aspnet45/src/PartsUnlimitedWebsite/Controllers/*
   ```

   に設定します。**Required**の要件があると、Web アプリのコントローラーコードに提案された変更をすべて承認する必要があります。

1. **Save**をクリックします。
